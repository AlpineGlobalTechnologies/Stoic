<h1>Portfolio Items</h1>

<div class="admin-actions">
  <%= link_to "+ New Portfolio Item", new_admin_portfolio_item_path, class: "btn btn-primary mb-3" %>
</div>

<table class="admin-table">
  <thead>
    <tr>
      <th>Title</th>
      <th>Category</th>
      <th>Iframe</th>
      <th>Created</th>
      <th>Visible</th>
      <th class="actions">Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @portfolio_items.each do |item| %>
      <tr>
        <td><%= item.title %></td>
        <td><span class="badge <%= item.category&.downcase %>"><%= item.category || "—" %></span></td>
        <td>
          <% if item.iframe_link.present? %>
            <%= link_to "Preview", item.iframe_link, target: "_blank", class: "link-preview" %>
          <% else %>
            —
          <% end %>
        </td>
        <td><%= item.created_at.strftime("%b %d, %Y") %></td>
        <td>
        <div class="form-check form-switch">
            <%= form_with url: admin_portfolio_item_path(item), method: :patch, data: { turbo: false } do |f| %>
            <%= f.check_box :active,
                            checked: item.active?,
                            onchange: "this.form.submit()",
                            class: "form-check-input",
                            id: "active-toggle-#{item.id}" %>
            <label class="form-check-label" for="active-toggle-<%= item.id %>">
                <%= item.active? ? "Yes" : "No" %>
            </label>
            <% end %>
        </div>
        </td>
        <td class="actions">
          <%= link_to "Show", admin_portfolio_item_path(item), class: "btn btn-sm btn-info" %>
          <%= link_to "Edit", edit_admin_portfolio_item_path(item), class: "btn btn-sm btn-warning" %>
          <%= button_to "Delete", admin_portfolio_item_path(item),
                        method: :delete,
                        data: { confirm: "Are you sure you want to delete '#{item.title}'?" },
                        class: "btn btn-sm btn-danger" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<% if @portfolio_items.empty? %>
  <p class="text-center mt-4">No portfolio items yet. <%= link_to "Create one", new_admin_portfolio_item_path %>.</p>
<% end %>